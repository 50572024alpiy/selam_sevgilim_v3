.map-layout{
  width: min(1200px, 92vw);
  margin: 0 auto;
  display: grid;
  grid-template-columns: 1.65fr 0.95fr;
  gap: 18px;
  padding: 8px 0 28px;
}

@media (max-width: 980px){
  .map-layout{ grid-template-columns: 1fr; }
}

.map-stage{
  position: relative;
  border-radius: var(--radius-xl);
  overflow: hidden;
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: var(--shadow-lg);
  background: rgba(var(--glass));
  min-height: 520px;
}

#map{
  width: 100%;
  height: clamp(520px, 70vh, 720px);
}

.map-watermark{
  position: absolute;
  left: 14px;
  bottom: 14px;
  padding: 10px 12px;
  border-radius: 999px;
  font-weight: 700;
  letter-spacing: -0.02em;
  font-size: 13px;
  color: rgb(var(--text));
  background: rgba(15,23,42,.72);
  border: 1px solid rgba(255,255,255,.10);
  backdrop-filter: blur(12px) saturate(120%);
  -webkit-backdrop-filter: blur(12px) saturate(120%);
  box-shadow: 0 10px 28px rgba(0,0,0,.35);
  pointer-events: none;
}

.map-grain{
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: .14;
  mix-blend-mode: overlay;
  background-image:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
}

.map-panel{
  border-radius: var(--radius-xl);
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(var(--glass));
  backdrop-filter: saturate(140%) blur(var(--blur));
  -webkit-backdrop-filter: saturate(140%) blur(var(--blur));
  box-shadow: var(--shadow-md);
  padding: 18px;
  display: grid;
  gap: 12px;
  align-content: start;
}

.panel-head h2{
  margin: 0;
  font-size: 18px;
  letter-spacing: -0.02em;
}
.panel-sub{
  margin-top: 6px;
  font-size: 13px;
  color: rgb(var(--muted));
}

.field{
  display: grid;
  gap: 8px;
}

.field label{
  font-size: 13px;
  color: rgb(var(--muted));
}

.field input, .field select{
  width: 100%;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(15,23,42,.55);
  color: rgb(var(--text));
  outline: none;
  box-shadow: 0 0 0 1px rgba(0,0,0,.18) inset;
}

.field input::placeholder{ color: rgba(148,163,184,.75); }

.field input:focus, .field select:focus{
  border-color: rgba(var(--primary-2), .45);
  box-shadow: 0 0 0 4px rgba(45,212,191,.12);
}

.actions{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-top: 6px;
}

.btn{
  cursor: pointer;
  border-radius: 16px;
  padding: 12px 12px;
  border: 1px solid rgba(255,255,255,.10);
  font-weight: 700;
  letter-spacing: -0.01em;
  background: rgba(15,23,42,.55);
  color: rgb(var(--text));
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}

.btn:disabled{
  opacity: .55;
  cursor: not-allowed;
}

.btn:active{ transform: translateY(1px); }

.btn-primary{
  background: linear-gradient(100deg, rgba(var(--accent-pink), .95), rgba(var(--primary), .92));
  border-color: rgba(255,255,255,.14);
  box-shadow: 0 18px 40px rgba(236,72,153,.18);
}

.btn-ghost:hover{
  border-color: rgba(148,163,184,.35);
}

.pins{
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,.08);
}

.pins-head{
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.pins-title{
  font-weight: 800;
  letter-spacing: -0.02em;
}

.pins-actions{
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.chip{
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(15,23,42,.50);
  color: rgb(var(--text));
  padding: 8px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
}

.chip-file{ display: inline-flex; align-items: center; gap: 8px; }

.pins-list{
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 10px;
  max-height: 280px;
  overflow: auto;
}

.pins-item{
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(15,23,42,.44);
  border-radius: 18px;
  padding: 12px;
  display: grid;
  gap: 6px;
}

.pins-top{
  display: flex;
  justify-content: space-between;
  gap: 10px;
  align-items: baseline;
}

.pins-place{
  font-weight: 800;
  letter-spacing: -0.02em;
}

.pins-note{
  color: rgb(var(--muted));
  font-size: 13px;
}

.pins-row{
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.small-btn{
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(15,23,42,.55);
  color: rgb(var(--text));
  padding: 8px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 800;
  cursor: pointer;
}

.small-btn:hover{ border-color: rgba(var(--primary-2), .35); }

.back-home{
  margin-top: 6px;
  display: inline-flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  color: rgb(var(--muted));
  font-weight: 700;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(15,23,42,.35);
}

.back-home:hover{
  color: rgb(var(--text));
  border-color: rgba(255,255,255,.14);
}

.leaflet-div-icon{
  background: transparent;
  border: none;
}

.heart-pin{
  width: 34px;
  height: 34px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  transform: translateY(-6px);
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.28), transparent 45%),
              linear-gradient(135deg, rgba(var(--accent-pink), .98), rgba(var(--primary), .92));
  border: 1px solid rgba(255,255,255,.18);
  box-shadow: 0 18px 40px rgba(236,72,153,.22), 0 6px 18px rgba(0,0,0,.45);
}

.heart-pin span{
  font-size: 16px;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,.5));
}

.leaflet-control-zoom a{
  background: rgba(15,23,42,.75) !important;
  color: rgb(var(--text)) !important;
  border: 1px solid rgba(255,255,255,.12) !important;
}
.leaflet-popup-content-wrapper{
  background: rgba(15,23,42,.92);
  color: rgb(var(--text));
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 18px;
}
.leaflet-popup-tip{
  background: rgba(15,23,42,.92);
}